#include <fcntl.h>
#include <stdlib.h>
#include <unistd.h>

#include "get_next_line/get_next_line.h"
#include "unity.h"
#include "unity_internals.h"

char *get_next_line (int fd);

void
setUp (void)
{
}

void
tearDown (void)
{
}

void
test_file_not_found (void)
{
  char *line;
  int fd;

  fd = open ("inputs/not_found", O_RDONLY);

  line = get_next_line (fd);
  TEST_ASSERT_NULL (line);
  free (line);

  line = get_next_line (fd);
  TEST_ASSERT_NULL (line);
  free (line);

  line = get_next_line (fd);
  TEST_ASSERT_NULL (line);
  free (line);

  close (fd);
}

void
test_empty (void)
{
  char *line;
  int fd;

  fd = open ("inputs/empty", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    NULL,
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "\n",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_41_no_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/41_no_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "01234567890123456789012345678901234567890",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_41_with_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/41_with_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "0123456789012345678901234567890123456789\n",
    "0",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_42_no_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/42_no_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "012345678901234567890123456789012345678901",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_42_with_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/42_with_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "01234567890123456789012345678901234567890\n",
    "1",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_multiple_nlx5 (void)
{
  char *line;
  int fd;

  fd = open ("inputs/multiple_nlx5", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "\n", "\n", "\n", "\n", "\n", NULL, NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_multiple_line_no_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/multiple_line_no_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "01234567890123456789012345678901234567890\n",
    "987654321098765432109876543210987654321098\n",
    "0123456789012345678901234567890123456789012\n",
    "987654321098765432109876543210987654321098\n",
    "01234567890123456789012345678901234567890",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_multiple_line_with_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/multiple_line_with_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "9876543210987654321098765432109876543210\n",
    "01234567890123456789012345678901234567890\n",
    "987654321098765432109876543210987654321098\n",
    "01234567890123456789012345678901234567890\n",
    "9876543210987654321098765432109876543210\n",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_alternate_line_nl_no_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/alternate_line_nl_no_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "98765432109876543210987654321098765432109\n",
    "\n",
    "012345678901234567890123456789012345678901\n",
    "\n",
    "9876543210987654321098765432109876543210987\n",
    "\n",
    "012345678901234567890123456789012345678901\n",
    "\n",
    "98765432109876543210987654321098765432109",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_alternate_line_nl_with_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/alternate_line_nl_with_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "01234567890123456789012345678901234567890\n",
    "\n",
    "987654321098765432109876543210987654321090\n",
    "\n",
    "0123456789012345678901234567890123456789012\n",
    "\n",
    "987654321098765432109876543210987654321090\n",
    "\n",
    "01234567890123456789012345678901234567890\n",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_big_line_no_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/big_line_no_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "890123456789012345678901234567890123456789012345678901234567890123456789",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

void
test_big_line_with_nl (void)
{
  char *line;
  int fd;

  fd = open ("inputs/big_line_with_nl", O_RDONLY);
  TEST_ASSERT_GREATER_THAN_INT (-1, fd);

  char *strings[] = {
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "8901234567890123456789012345678901234567890123456789012345678901234567890"
    "1234567890123456789012345678901234567890123456789012345678901234567890123"
    "4567890123456789012345678901234567890123456789012345678901234567890123456"
    "7890123456789012345678901234567890123456789012345678901234567890123456789"
    "0123456789012345678901234567890123456789012345678901234567890123456789012"
    "3456789012345678901234567890123456789012345678901234567890123456789012345"
    "6789012345678901234567890123456789012345678901234567890123456789012345678"
    "9012345678901234567890123456789012345678901234567890123456789012345678901"
    "2345678901234567890123456789012345678901234567890123456789012345678901234"
    "5678901234567890123456789012345678901234567890123456789012345678901234567"
    "890123456789012345678901234567890123456789012345678901234567890123456789"
    "\n",
    NULL,
    NULL,
  };

  int count = sizeof (strings) / sizeof (strings[0]);

  for (int i = 0; i < count; i++)
    {
      line = get_next_line (fd);
      TEST_ASSERT_EQUAL_STRING (strings[i], line);
      free (line);
    }

  close (fd);
}

int
main (void)
{
  UNITY_BEGIN ();

  printf ("################################\n");
  printf ("### BUFFER_SIZE = %010d ###\n", BUFFER_SIZE);
  printf ("################################\n\n");

  RUN_TEST (test_file_not_found);
  RUN_TEST (test_empty);
  RUN_TEST (test_nl);
  RUN_TEST (test_41_no_nl);
  RUN_TEST (test_41_with_nl);
  RUN_TEST (test_42_no_nl);
  RUN_TEST (test_42_with_nl);
  RUN_TEST (test_multiple_nlx5);
  RUN_TEST (test_multiple_line_no_nl);
  RUN_TEST (test_multiple_line_with_nl);
  RUN_TEST (test_alternate_line_nl_no_nl);
  RUN_TEST (test_alternate_line_nl_with_nl);
  RUN_TEST (test_big_line_no_nl);
  RUN_TEST (test_big_line_with_nl);

  return UNITY_END ();
}
